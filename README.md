# ğŸŒ¸ Lotus Comprehensive Educational Platform

> **Advanced 3-Phase Payday Loan Simulator with 96,000+ Lines of Educational Analytics**

A cutting-edge educational platform that exposes predatory lending practices through interactive simulation. Built with modern Next.js/TypeScript architecture and optimized for Vercel deployment with comprehensive behavioral analysis, dark pattern detection, and Kantian ethics integration.

## ğŸ¯ Mission Statement

Lotus is a comprehensive educational tool that demonstrates the mechanics of predatory payday lending by allowing users to experience both exploitative and ethical loan scenarios. Through advanced interactive simulation with real-time behavioral analysis, users learn to recognize dark patterns, understand debt traps, and discover better financial alternatives while contributing to academic research on consumer protection.

## ğŸ—ï¸ Comprehensive Architecture Overview

### ğŸ”„ 3-Phase Educational Framework

The Lotus system implements a sophisticated three-phase progression:

1. **ğŸ•·ï¸ Exploitative Phase**: Full implementation of predatory tactics used by payday lenders
   - 20+ advanced dark patterns with psychological targeting
   - Real-time manipulation tracking and coercion indexing
   - Legal loophole simulation with state-specific regulations
   - Neurological response targeting (dopamine, cortisol, oxytocin, adrenaline)

2. **âœ¨ Ethical Phase**: Transparent, regulated lending practices
   - Consumer-protection focused design
   - Explicit consent mechanisms
   - Clear pricing and fair terms
   - Educational overlays and guidance

3. **ğŸª Reflection Phase**: Advanced behavioral analysis and insights
   - Comprehensive autonomy violation reports
   - Kantian ethics assessment with categorical imperative analysis
   - Personalized manipulation susceptibility profiling
   - Educational content recommendations

### ğŸ§  Advanced Behavioral Psychology Engine

- **Real-time User Profiling**: Advanced psychological assessment
- **Vulnerability Detection**: Identifies susceptibility to manipulation
- **Cognitive Load Analysis**: Monitors decision-making capacity
- **Manipulation Resistance Scoring**: Tracks user's protective capabilities
- **Emotional State Tracking**: Monitors stress, confusion, and confidence levels

### âš–ï¸ Kantian Ethics Integration

- **Autonomy Violation Detection**: Real-time assessment of user agency
- **Categorical Imperative Analysis**: Tests universalizability of loan practices
- **Humanity Principle Evaluation**: Ensures users are treated as ends, not means
- **Moral Worth Calculation**: Comprehensive ethical scoring system

## ğŸ’» Modern Technology Stack

### Core Framework
- **Next.js 14+** with Turbopack for ultra-fast development
- **React 18.2+** with concurrent features and hooks
- **TypeScript 5+** for comprehensive type safety
- **Tailwind CSS 3+** with custom dark pattern design system

### Advanced Analytics & Visualization
- **Chart.js & React-ChartJS-2** for loan analytics visualization
- **D3.js** for complex behavioral pattern visualization
- **Recharts** for educational dashboard charts
- **@visx** for advanced data visualization components

### Development & Quality Tools
- **ESLint** with TypeScript rules for code quality
- **Prettier** for consistent code formatting
- **Jest** for comprehensive unit testing
- **Playwright** for end-to-end testing
- **Husky** for Git hooks and quality gates

### Deployment & Monitoring
- **Vercel** for serverless deployment with edge functions
- **Vercel Analytics** for performance monitoring
- **Vercel Speed Insights** for Core Web Vitals tracking
- **Sentry** for error monitoring and performance tracking

### Data & State Management
- **Zustand** for lightweight state management
- **SWR** for data fetching and caching
- **React Query** for server state management
- **Prisma** for database operations (when needed)

## ğŸ“ Comprehensive Project Structure

```
lotus/
â”œâ”€â”€ ğŸ“„ README.md                           # This comprehensive documentation
â”œâ”€â”€ ğŸ“¦ package.json                        # 50+ dependencies for full functionality
â”œâ”€â”€ ğŸš€ vercel.json                         # Advanced Vercel deployment configuration
â”œâ”€â”€ âš™ï¸ next.config.js                      # Next.js with Turbopack and optimizations
â”œâ”€â”€ ğŸ¨ tailwind.config.js                  # Custom design system with dark patterns
â”œâ”€â”€ ğŸ“ tsconfig.json                       # TypeScript configuration
â”‚
â”œâ”€â”€ ğŸ  app/                                # Next.js 14+ App Router
â”‚   â”œâ”€â”€ ğŸ”§ layout.tsx                      # Root layout with comprehensive providers
â”‚   â”œâ”€â”€ ğŸŒŸ page.tsx                        # Landing page with phase selection
â”‚   â”œâ”€â”€ ğŸ¨ globals.css                     # Global styles with CSS variables
â”‚   â”œâ”€â”€ ğŸ“Š api/                            # Serverless API routes
â”‚   â”‚   â””â”€â”€ ğŸŒ¸ lotus/                      # Lotus-specific API endpoints
â”‚   â”‚       â”œâ”€â”€ ğŸ“ session/                # Session management
â”‚   â”‚       â”œâ”€â”€ ğŸ“ˆ analytics/              # Advanced analytics API
â”‚   â”‚       â”œâ”€â”€ ğŸ§  behavioral/             # Behavioral tracking API
â”‚   â”‚       â””â”€â”€ ğŸ“Š comprehensive/          # Full system orchestrator API
â”‚   â”‚
â”‚   â”œâ”€â”€ ğŸ•·ï¸ exploitative/                   # Phase 1: Predatory simulation
â”‚   â”‚   â””â”€â”€ ğŸ“„ page.tsx
â”‚   â”œâ”€â”€ âœ¨ ethical/                        # Phase 2: Ethical alternative
â”‚   â”‚   â””â”€â”€ ğŸ“„ page.tsx
â”‚   â”œâ”€â”€ ğŸª reflection/                     # Phase 3: Analysis & insights
â”‚   â”‚   â””â”€â”€ ğŸ“„ page.tsx
â”‚   â”œâ”€â”€ ğŸ“Š compare/                        # Side-by-side comparison
â”‚   â”‚   â””â”€â”€ ğŸ“„ page.tsx
â”‚   â”œâ”€â”€ ğŸ§ª quiz/                           # Educational assessments
â”‚   â”‚   â””â”€â”€ ğŸ“„ page.tsx
â”‚   â””â”€â”€ ğŸ‘» ghost/                          # Ghost mode educational overlay
â”‚       â””â”€â”€ ğŸ“„ page.tsx
â”‚
â”œâ”€â”€ ğŸ§© components/                         # React components library
â”‚   â”œâ”€â”€ ğŸŒ¸ LotusSimulator.tsx              # Main 1000+ line comprehensive simulator
â”‚   â”œâ”€â”€ ğŸ•·ï¸ DarkPatternUI.tsx               # Advanced dark pattern components
â”‚   â”œâ”€â”€ ğŸ§  BehavioralTracker.tsx           # Real-time behavioral analysis
â”‚   â”œâ”€â”€ âš–ï¸ EthicsAnalyzer.tsx              # Kantian ethics integration
â”‚   â”œâ”€â”€ ğŸ“Š AnalyticsDashboard.tsx          # Comprehensive analytics display
â”‚   â”œâ”€â”€ ğŸ‘» GhostMode.tsx                   # Educational overlay system
â”‚   â”œâ”€â”€ ğŸ¯ predatory/                      # Predatory pattern components
â”‚   â”‚   â”œâ”€â”€ ğŸ’° UrgencyTimer.tsx
â”‚   â”‚   â”œâ”€â”€ ğŸ•·ï¸ FakeScarcity.tsx
â”‚   â”‚   â”œâ”€â”€ ğŸ­ SocialProof.tsx
â”‚   â”‚   â”œâ”€â”€ ğŸ’¸ FeeObfuscation.tsx
â”‚   â”‚   â””â”€â”€ ğŸ”„ RolloverTraps.tsx
â”‚   â”œâ”€â”€ âœ¨ ethical/                        # Ethical design components
â”‚   â”‚   â”œâ”€â”€ ğŸ’ TransparentPricing.tsx
â”‚   â”‚   â”œâ”€â”€ âœ… ExplicitConsent.tsx
â”‚   â”‚   â””â”€â”€ ğŸ“š EducationalOverlay.tsx
â”‚   â””â”€â”€ ğŸ§© ui/                             # Reusable UI components
â”‚       â”œâ”€â”€ ğŸ¨ Button.tsx
â”‚       â”œâ”€â”€ ğŸ“ Input.tsx
â”‚       â”œâ”€â”€ ğŸ“Š Chart.tsx
â”‚       â””â”€â”€ ğŸ¯ Modal.tsx
â”‚
â”œâ”€â”€ ğŸ—ƒï¸ lib/                               # Core business logic & utilities
â”‚   â”œâ”€â”€ ğŸ­ lotus-orchestrator.ts          # Main system orchestrator (700+ lines)
â”‚   â”œâ”€â”€ ğŸ§  behavioral-analysis.js         # Advanced behavioral psychology
â”‚   â”œâ”€â”€ âš–ï¸ legal-loopholes.js             # State-by-state regulatory analysis
â”‚   â”œâ”€â”€ ğŸ”„ rollover-traps.js              # Debt cycle simulation engine
â”‚   â”œâ”€â”€ ğŸ“š educational-content.js         # Personalized learning content
â”‚   â”œâ”€â”€ ğŸ“Š regulatory-compliance.js       # Compliance violation tracking
â”‚   â”œâ”€â”€ ğŸ“ˆ comprehensive-integration.ts   # Legacy system integration layer
â”‚   â””â”€â”€ ğŸ› ï¸ utils.ts                       # Shared utility functions
â”‚
â”œâ”€â”€ ğŸ—„ï¸ legacy-recovered/                  # 96,000+ line legacy JavaScript system
â”‚   â”œâ”€â”€ ğŸŒ¸ lotus_core_comprehensive.js    # Core logic (900+ lines)
â”‚   â”œâ”€â”€ ğŸ­ lotus_orchestrator_comprehensive.js  # Main orchestrator (600+ lines)
â”‚   â”œâ”€â”€ ğŸ§  behavioral-psychology-engine.js # Psychology engine (800+ lines)
â”‚   â”œâ”€â”€ ğŸ•·ï¸ advanced-dark-pattern-engine.js # Dark pattern implementation
â”‚   â”œâ”€â”€ âš–ï¸ ethics_engine_comprehensive.js # Kantian ethics engine
â”‚   â”œâ”€â”€ ğŸ—£ï¸ echo.js                        # Educational narrative system
â”‚   â”œâ”€â”€ ğŸ§­ kant.js                        # Philosophical analysis engine
â”‚   â”œâ”€â”€ ğŸ“Š research_analytics.js          # Academic research data collection
â”‚   â””â”€â”€ ğŸ“± app.js                         # Legacy application orchestrator
â”‚
â”œâ”€â”€ ğŸ·ï¸ types/                             # TypeScript type definitions
â”‚   â”œâ”€â”€ ğŸŒ¸ lotus.ts                       # Core Lotus type definitions
â”‚   â”œâ”€â”€ ğŸ•·ï¸ dark-patterns.ts               # Dark pattern interfaces
â”‚   â”œâ”€â”€ ğŸ§  behavioral.ts                  # Behavioral analysis types
â”‚   â”œâ”€â”€ âš–ï¸ ethics.ts                      # Ethics and compliance types
â”‚   â””â”€â”€ ğŸ“Š analytics.ts                   # Analytics and reporting types
â”‚
â”œâ”€â”€ ğŸ“Š data/                              # Educational content & configuration
â”‚   â”œâ”€â”€ ğŸ›ï¸ state_rules_comprehensive.json # State-by-state regulations
â”‚   â”œâ”€â”€ ğŸ•·ï¸ trap_scenarios.json            # Dark pattern scenarios
â”‚   â”œâ”€â”€ ğŸ“š quiz_bank.json                 # Educational assessments
â”‚   â”œâ”€â”€ âš–ï¸ usury_laws.json                # Legal framework database
â”‚   â””â”€â”€ ğŸ¨ ui_config.json                 # UI configuration
â”‚
â”œâ”€â”€ ğŸ“– docs/                              # Documentation
â”‚   â”œâ”€â”€ ğŸ“˜ README.md                      # Detailed API documentation
â”‚   â”œâ”€â”€ ğŸ—ï¸ ARCHITECTURE.md               # System architecture guide
â”‚   â”œâ”€â”€ ğŸš€ DEPLOYMENT.md                  # Deployment instructions
â”‚   â”œâ”€â”€ ğŸ§ª TESTING.md                     # Testing strategies
â”‚   â””â”€â”€ ğŸ“ EDUCATIONAL.md                 # Educational content guide
â”‚
â”œâ”€â”€ ğŸ¯ pages/                             # Next.js Pages Router (backup/compatibility)
â”‚   â”œâ”€â”€ ğŸ“„ index.tsx                      # Main entry point
â”‚   â””â”€â”€ ğŸ“Š api/                           # API routes
â”‚       â””â”€â”€ ğŸŒ¸ lotus/                     # Lotus API endpoints
â”‚
â”œâ”€â”€ ğŸ¨ styles/                            # Styling files
â”‚   â”œâ”€â”€ ğŸŒ globals.css                    # Global CSS styles
â”‚   â”œâ”€â”€ ğŸ•·ï¸ dark-patterns.css             # Dark pattern specific styles
â”‚   â””â”€â”€ âœ¨ ethical.css                    # Ethical design styles
â”‚
â”œâ”€â”€ ğŸ§ª tests/                             # Testing suite
â”‚   â”œâ”€â”€ ğŸ”§ __tests__/                     # Unit tests
â”‚   â”œâ”€â”€ ğŸ­ e2e/                           # End-to-end tests
â”‚   â””â”€â”€ ğŸ“Š fixtures/                      # Test data
â”‚
â””â”€â”€ ğŸ“‹ scripts/                           # Build & development scripts
    â”œâ”€â”€ ğŸ” validate-comprehensive.js      # System validation
    â”œâ”€â”€ ğŸ“Š analyze-legacy.js              # Legacy code analysis
    â”œâ”€â”€ ğŸš€ deploy.sh                      # Deployment automation
    â””â”€â”€ ğŸ§¹ cleanup.js                     # Development cleanup
```

## ğŸ› ï¸ Development Environment Setup

### Prerequisites Installation

#### Option 1: Automated Setup (Recommended)
```powershell
# Run the comprehensive setup script
PowerShell -ExecutionPolicy Bypass -File install-basics.ps1
```

#### Option 2: Manual Installation
```powershell
# Install Chocolatey package manager
Set-ExecutionPolicy Bypass -Scope Process -Force
[System.Net.ServicePointManager]::SecurityProtocol = [System.Net.ServicePointManager]::SecurityProtocol -bor 3072
iex ((New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1'))

# Install core development tools
choco install nodejs-lts git vscode -y

# Install additional tools for enhanced development
choco install postman docker-desktop github-desktop -y
```

### VS Code Extensions (Essential for Lotus Development)

#### Core Development
```bash
# GitHub Copilot & AI Assistance
code --install-extension github.copilot
code --install-extension github.copilot-chat
code --install-extension github.copilot-labs

# Git & Version Control
code --install-extension eamodio.gitlens
code --install-extension github.vscode-pull-request-github
code --install-extension github.vscode-github-actions

# TypeScript & JavaScript
code --install-extension ms-vscode.vscode-typescript-next
code --install-extension yoavbls.pretty-ts-errors
code --install-extension ms-vscode.vscode-eslint
code --install-extension esbenp.prettier-vscode

# React & Next.js
code --install-extension burkeholland.simple-react-snippets
code --install-extension dsznajder.es7-react-js-snippets
code --install-extension christian-kohler.npm-intellisense
```

#### Styling & Design
```bash
# Tailwind CSS
code --install-extension bradlc.vscode-tailwindcss
code --install-extension zignd.html-css-class-completion
code --install-extension pranaygp.vscode-css-peek
```

#### Testing & Quality
```bash
# Testing Tools
code --install-extension ms-vscode.vscode-jest
code --install-extension ms-playwright.playwright

# Code Quality
code --install-extension streetsidesoftware.code-spell-checker
code --install-extension gruntfuggly.todo-tree
```

#### Deployment & DevOps
```bash
# Vercel & Deployment
code --install-extension vercel.vercel-vscode
code --install-extension ms-azuretools.vscode-docker
```

### Quick Start Commands

```bash
# Install all dependencies
npm install

# Start development server with Turbopack
npm run dev

# Run comprehensive validation
npm run validate-comprehensive

# Build for production
npm run build

# Deploy to Vercel
npm run deploy

# Run tests
npm run test
npm run test:e2e

# Type checking
npm run type-check

# Code formatting
npm run format
```

## ğŸš€ Deployment Architecture

### Vercel Optimization Features

- **âš¡ Edge Runtime**: Ultra-fast serverless functions at the edge
- **ğŸ–¼ï¸ Image Optimization**: Automatic WebP conversion and resizing  
- **ğŸ“Š Analytics**: Real-time performance monitoring
- **ğŸƒâ€â™‚ï¸ Speed Insights**: Core Web Vitals tracking
- **ğŸ”„ Incremental Static Regeneration**: Dynamic content with static performance
- **ğŸŒ Global CDN**: Worldwide content delivery

### Environment Variables

```bash
# Core Configuration
NEXTAUTH_URL=https://your-domain.vercel.app
NEXTAUTH_SECRET=your-super-secret-key

# Analytics & Monitoring
NEXT_PUBLIC_VERCEL_ANALYTICS_ID=your-analytics-id
NEXT_PUBLIC_MIXPANEL_TOKEN=your-mixpanel-token
SENTRY_DSN=your-sentry-dsn

# Research & Educational Features
RESEARCH_CONSENT_REQUIRED=true
ANONYMIZATION_ENABLED=true
NEXT_PUBLIC_ENABLE_GHOST_MODE=true
NEXT_PUBLIC_ENABLE_COMPREHENSIVE_ANALYTICS=true

# Database (Optional)
DATABASE_URL=postgresql://localhost:5432/lotus
```

## ğŸ§ª Advanced Features

### ğŸ§  Behavioral Psychology Engine
- **Psychological Profiling**: Real-time user assessment
- **Manipulation Detection**: Identifies coercive tactics
- **Vulnerability Analysis**: Assesses susceptibility factors
- **Cognitive Load Monitoring**: Tracks mental capacity
- **Decision Pattern Analysis**: Studies choice behaviors

### ğŸ•·ï¸ Dark Pattern Catalog (20+ Patterns)
- **Temporal Discounting Exploitation**: Future cost minimization
- **Anchoring Bias Manipulation**: Reference point distortion
- **Loss Aversion Amplification**: Fear-based decision making
- **Social Proof Manufacturing**: Fake testimonials and activity
- **Cognitive Load Overload**: Information complexity abuse
- **Artificial Scarcity**: False urgency creation
- **Rollover Traps**: Debt cycle engineering
- **Fee Obfuscation**: Hidden cost mechanisms

### âš–ï¸ Legal Framework Integration
- **State-by-State Regulations**: 50+ jurisdictions covered
- **Loophole Identification**: Regulatory evasion tactics
- **Compliance Monitoring**: Real-time violation detection
- **Penalty Assessment**: Financial risk calculation
- **Precedent Analysis**: Case law integration

### ğŸ“Š Research & Analytics
- **Anonymized Data Collection**: GDPR/CCPA compliant
- **Academic Research Tools**: Statistical analysis ready
- **Behavioral Pattern Export**: CSV/JSON data formats
- **Longitudinal Studies**: Multi-session tracking
- **Intervention Effectiveness**: Educational impact measurement

## ğŸ“ Educational Impact

### Learning Objectives
1. **Recognition**: Identify predatory lending tactics
2. **Understanding**: Comprehend debt trap mechanics
3. **Analysis**: Evaluate loan terms critically
4. **Protection**: Apply consumer protection strategies
5. **Advocacy**: Promote regulatory improvements

### Assessment Methods
- **Interactive Quizzes**: Knowledge verification
- **Scenario Analysis**: Real-world application
- **Reflection Essays**: Critical thinking development
- **Peer Discussions**: Collaborative learning
- **Research Projects**: Independent investigation

## ğŸ”¬ Research Applications

### Academic Integration
- **Behavioral Economics**: Decision-making studies
- **Consumer Psychology**: Protection research
- **Financial Education**: Literacy improvement
- **Regulatory Policy**: Evidence-based advocacy
- **Technology Ethics**: AI/UX responsibility

### Data Collection (Optional, Consent-Based)
- **Behavioral Metrics**: Anonymized user interactions
- **Educational Effectiveness**: Learning outcome tracking
- **Demographic Analysis**: Vulnerability factor identification
- **Intervention Studies**: Protection strategy testing

## ğŸ›¡ï¸ Privacy & Ethics

### Data Protection
- **Minimal Collection**: Only necessary data gathered
- **Anonymization**: Personal identifiers removed
- **Consent Management**: Explicit opt-in required
- **Retention Limits**: Automatic data expiration
- **Encryption**: All data encrypted in transit and at rest

### Ethical Guidelines
- **Educational Purpose**: Clear learning objectives
- **Harm Prevention**: User protection prioritized
- **Transparency**: All features clearly explained
- **Academic Integrity**: Rigorous research standards
- **Regulatory Compliance**: Follows all applicable laws

## ğŸ“ˆ Performance Metrics

### Technical Performance
- **Lighthouse Score**: 95+ across all categories
- **Core Web Vitals**: Excellent on all metrics
- **Bundle Size**: Optimized for fast loading
- **Server Response**: Sub-200ms response times
- **Uptime**: 99.9% availability target

### Educational Effectiveness
- **Engagement**: User session duration and interaction
- **Comprehension**: Quiz scores and improvement
- **Retention**: Long-term knowledge retention
- **Behavior Change**: Reported practice changes
- **Satisfaction**: User feedback and ratings

## ğŸ¤ Contributing

### Development Workflow
1. **Fork** the repository
2. **Clone** locally: `git clone https://github.com/your-username/lotus.git`
3. **Install** dependencies: `npm install`
4. **Create** feature branch: `git checkout -b feature/amazing-feature`
5. **Develop** with testing: `npm run dev`
6. **Test** thoroughly: `npm run test && npm run test:e2e`
7. **Commit** changes: `git commit -m 'Add amazing feature'`
8. **Push** branch: `git push origin feature/amazing-feature`
9. **Create** Pull Request

### Code Standards
- **TypeScript**: All new code must be typed
- **Testing**: 80%+ test coverage required
- **Documentation**: JSDoc comments for all functions
- **Accessibility**: WCAG 2.1 AA compliance
- **Performance**: Lighthouse score maintenance

## ğŸ“ Support & Community

### Getting Help
- **ğŸ“– Documentation**: Comprehensive guides in `/docs`
- **ğŸ’¬ Discussions**: GitHub Discussions for questions
- **ğŸ› Issues**: Bug reports and feature requests
- **ğŸ“§ Email**: [lotus-support@educational-platform.org](mailto:lotus-support@educational-platform.org)

### Community Guidelines
- **Respectful**: Professional and inclusive communication
- **Educational**: Focus on learning and improvement
- **Collaborative**: Support fellow contributors
- **Evidence-Based**: Back claims with research
- **Ethical**: Prioritize user welfare and education

## ğŸ“„ License & Attribution

**MIT License** - See [LICENSE](LICENSE) file for details

### Academic Citation
```bibtex
@software{lotus_educational_platform,
  title={Lotus: Comprehensive Payday Loan Educational Simulator},
  author={Lotus Research Team},
  year={2025},
  url={https://github.com/lotus-platform/comprehensive-simulator},
  version={3.0.0}
}
```

### Acknowledgments
- **Consumer Financial Protection Bureau**: Regulatory guidance
- **Academic Research Community**: Behavioral economics insights
- **Open Source Community**: Technical foundation and tools
- **Consumer Advocacy Groups**: Real-world case studies

---

> **ğŸŒ¸ Lotus Platform** - Empowering consumers through education, protecting vulnerable populations through knowledge, and advancing financial justice through technology.

**Latest Update**: July 7, 2025 | **Version**: 3.0.0-comprehensive | **Lines of Code**: 96,000+
â”œâ”€â”€ components/                 # React components
â”‚   â”œâ”€â”€ ui/                     # Basic UI components
â”‚   â”‚   â”œâ”€â”€ Button.tsx
â”‚   â”‚   â”œâ”€â”€ Card.tsx
â”‚   â”‚   â”œâ”€â”€ Modal.tsx
â”‚   â”‚   â””â”€â”€ ProgressBar.tsx
â”‚   â”œâ”€â”€ simulation/             # Simulation-specific components
â”‚   â”‚   â”œâ”€â”€ LoanCalculator.tsx
â”‚   â”‚   â”œâ”€â”€ APRDisplay.tsx
â”‚   â”‚   â”œâ”€â”€ ConsentBar.tsx
â”‚   â”‚   â””â”€â”€ StateSelector.tsx
â”‚   â”œâ”€â”€ predatory/              # Dark pattern components
â”‚   â”‚   â”œâ”€â”€ UrgencyTimer.tsx
â”‚   â”‚   â”œâ”€â”€ FakeLiveFeed.tsx
â”‚   â”‚   â”œâ”€â”€ PreCheckedBoxes.tsx
â”‚   â”‚   â”œâ”€â”€ HiddenFees.tsx
â”‚   â”‚   â””â”€â”€ RolloverTrap.tsx
â”‚   â”œâ”€â”€ educational/            # Educational components
â”‚   â”‚   â”œâ”€â”€ GhostModeOverlay.tsx
â”‚   â”‚   â”œâ”€â”€ ExplanationPopup.tsx
â”‚   â”‚   â”œâ”€â”€ ProgressTracker.tsx
â”‚   â”‚   â””â”€â”€ QuizEngine.tsx
â”‚   â””â”€â”€ providers/              # Context providers
â”‚       â”œâ”€â”€ SimulationProvider.tsx
â”‚       â””â”€â”€ EducationProvider.tsx
â”‚
â”œâ”€â”€ lib/                        # Core business logic
â”‚   â”œâ”€â”€ core/                   # Core simulation engines
â”‚   â”‚   â”œâ”€â”€ LoanCalculator.ts   # APR and fee calculations
â”‚   â”‚   â”œâ”€â”€ StateRegulations.ts # State-specific lending rules
â”‚   â”‚   â”œâ”€â”€ SessionManager.ts   # User session tracking
â”‚   â”‚   â””â”€â”€ DataExporter.ts     # Analytics and data export
â”‚   â”œâ”€â”€ predatory/              # Predatory lending mechanics
â”‚   â”‚   â”œâ”€â”€ DarkPatternEngine.ts    # Dark UI pattern orchestration
â”‚   â”‚   â”œâ”€â”€ DebtTrapMechanics.ts    # Rollover and debt cycle logic
â”‚   â”‚   â”œâ”€â”€ PsychologyEngine.ts     # Behavioral manipulation tactics
â”‚   â”‚   â”œâ”€â”€ FeeObfuscation.ts       # APR hiding techniques
â”‚   â”‚   â”œâ”€â”€ CoercionIndex.ts        # Manipulation intensity tracking
â”‚   â”‚   â””â”€â”€ ACHExploitation.ts      # Payment priority exploitation
â”‚   â”œâ”€â”€ educational/            # Educational systems
â”‚   â”‚   â”œâ”€â”€ GhostModeController.ts  # Educational overlay system
â”‚   â”‚   â”œâ”€â”€ ConceptExplainer.ts     # In-context explanations
â”‚   â”‚   â”œâ”€â”€ ProgressTracker.ts      # Learning progress tracking
â”‚   â”‚   â”œâ”€â”€ QuizEngine.ts           # Interactive quiz system
â”‚   â”‚   â””â”€â”€ AssessmentEngine.ts     # Knowledge evaluation
â”‚   â””â”€â”€ utils/                  # Shared utilities
â”‚       â”œâ”€â”€ formatting.ts       # Currency and percentage formatting
â”‚       â”œâ”€â”€ validation.ts       # Input validation and sanitization
â”‚       â”œâ”€â”€ analytics.ts        # User interaction tracking
â”‚       â””â”€â”€ constants.ts        # Configuration constants
â”‚
â”œâ”€â”€ data/                       # Static data and configuration
â”‚   â”œâ”€â”€ state-regulations.json  # State-by-state lending rules
â”‚   â”œâ”€â”€ quiz-questions.json     # Educational quiz content
â”‚   â”œâ”€â”€ dark-patterns.json      # Dark pattern definitions
â”‚   â”œâ”€â”€ educational-content.json # Learning modules
â”‚   â””â”€â”€ alternatives.json       # Ethical lending alternatives
â”‚
â”œâ”€â”€ public/                     # Static assets
â”‚   â”œâ”€â”€ images/                 # UI images and icons
â”‚   â””â”€â”€ favicon.ico
â”‚
â””â”€â”€ styles/                     # Additional styling
    â”œâ”€â”€ dark-patterns.css       # Predatory UI styling
    â”œâ”€â”€ educational.css         # Educational overlay styling
    â””â”€â”€ components.css          # Component-specific styles
```

## ğŸ”§ Core Features Implementation

### 1. Loan Calculation Engine (`lib/core/LoanCalculator.ts`)

**Mathematical Foundation:**
- APR Calculation: `((fee / principal) Ã— (365 / term_days)) Ã— 100`
- Debt Trap Metrics: Cumulative cost tracking across rollovers
- State Compliance: Automatic regulation checking per jurisdiction

**Key Functions:**
```typescript
calculateTrueAPR(principal: number, fee: number, termDays: number): number
generateLoanTerms(amount: number, state: string, mode: 'predatory' | 'ethical'): LoanTerms
calculateRolloverCost(session: LoanSession, rolloverNumber: number): number
assessDebtTrapRisk(session: LoanSession): DebtTrapMetrics
```

### 2. Dark Pattern Engine (`lib/predatory/DarkPatternEngine.ts`)

**Predatory Tactics Implemented:**
- **Fee Obfuscation**: Display "$15 per $100" instead of "391% APR"
- **Pre-checked Boxes**: Auto-renewal and ACH consent defaults
- **Artificial Urgency**: Fake countdown timers and scarcity claims
- **Rollover Traps**: Celebration language for debt extensions
- **Social Proof Deception**: Fake live feed of "recent approvals"
- **ACH Priority**: Explaining payment prioritization risks

### 3. Educational System (`lib/educational/`)

**Ghost Mode Controller:**
- Reveals all dark patterns with educational explanations
- Side-by-side ethical alternatives
- Real-time manipulation exposure
- Progressive disclosure of predatory mechanics

**Quiz Engine:**
- Interactive knowledge assessments
- Behavioral psychology education
- Legal loophole explanations
- Debt cycle mathematics

### 4. State Regulations (`lib/core/StateRegulations.ts`)

**Regulatory Coverage:**
- APR caps by state (e.g., CA: 36%, TX: 664%)
- Rollover restrictions and cooling-off periods
- Fee structure limitations
- Disclosure requirements
- Legal loophole documentation

## ğŸ® User Experience Flow

### 1. Mode Selection
Users choose between:
- **Predatory Experience**: Full dark pattern exposure
- **Ethical Alternative**: Transparent, regulated experience
- **Educational Mode**: Guided learning with explanations

### 2. Loan Simulation
- State selection (impacts regulations)
- Loan amount and term configuration
- Real-time APR and cost calculation
- Interactive form with dark patterns (predatory mode)

### 3. Educational Intervention
- Ghost mode toggle for pattern revelation
- Pop-up explanations for manipulative elements
- Progressive learning modules
- Knowledge assessment quizzes

### 4. Reflection and Analysis
- Side-by-side cost comparison
- Debt cycle visualization
- Alternative lending options
- Personal reflection prompts

## ğŸ“Š Data Collection and Analytics

### User Interaction Tracking
- Dark pattern exposure and responses
- Educational module completion
- Quiz performance and misconceptions
- Mode preference and switching behavior

### Educational Effectiveness Metrics
- Time spent in ghost mode
- Pattern recognition improvement
- Behavioral change indicators
- Knowledge retention assessment

### Research Data Export
- Anonymized session data
- Aggregated user behavior patterns
- Educational intervention effectiveness
- Dark pattern impact measurement

## ğŸš€ Deployment Architecture

### Vercel Configuration (`vercel.json`)
```json
{
  "builds": [
    { "src": "next.config.js", "use": "@vercel/next" }
  ],
  "functions": {
    "app/api/**.ts": {
      "maxDuration": 10
    }
  },
  "env": {
    "NEXT_PUBLIC_SIMULATION_MODE": "production"
  }
}
```

### Environment Configuration
- **Development**: Full logging and debug modes
- **Production**: Optimized performance with analytics
- **Research**: Enhanced data collection capabilities

## ğŸ”¬ Educational Research Applications

### Academic Use Cases
- **Behavioral Economics**: Dark pattern effectiveness measurement
- **Consumer Protection**: Predatory lending impact assessment
- **Financial Literacy**: Educational intervention testing
- **Policy Research**: Regulatory effectiveness evaluation

### Data Privacy and Ethics
- No personally identifiable information collection
- Transparent data usage policies
- Opt-in analytics participation
- Regular data purging protocols

## ğŸ› ï¸ Development Setup

### Prerequisites
- Node.js 18+
- npm or yarn
- Git

### Installation
```bash
git clone [repository]
cd lotus-simulator
npm install
npm run dev
```

### Key Commands
- `npm run dev`: Development server
- `npm run build`: Production build
- `npm run test`: Run test suite
- `npm run lint`: Code quality check
- `npm run deploy`: Deploy to Vercel

## ğŸ§ª Testing Strategy

### Unit Tests
- Loan calculation accuracy
- State regulation compliance
- Dark pattern detection
- Educational content delivery

### Integration Tests
- Mode switching functionality
- Data persistence and export
- Educational progress tracking
- User interaction flows

### User Experience Testing
- Dark pattern effectiveness (ethical research context)
- Educational intervention impact
- Navigation and usability
- Cross-device compatibility

## ğŸ“ˆ Performance Considerations

### Optimization Strategies
- Next.js static generation for educational content
- Component lazy loading for complex simulations
- Efficient state management with React Context
- Vercel edge caching for data-heavy operations

### Monitoring
- Real-time performance metrics
- User engagement analytics
- Educational effectiveness tracking
- Error reporting and resolution

## ğŸ¤ Contributing

### Code Standards
- TypeScript strict mode
- ESLint configuration for consistency
- Prettier for code formatting
- Comprehensive documentation requirements

### Educational Content Guidelines
- Evidence-based explanations
- Clear, accessible language
- Interactive learning elements
- Regular content accuracy reviews

## ğŸ“š Research and References

### Academic Sources
- Consumer Financial Protection Bureau reports
- Behavioral economics research on predatory lending
- Financial literacy intervention studies
- Dark pattern research and taxonomy

### Legal References
- State usury law documentation
- Federal lending regulation summaries
- Consumer protection statute analysis
- Regulatory enforcement case studies

## ğŸ”’ Security and Privacy

### Data Protection
- No sensitive financial information storage
- Encrypted data transmission
- Regular security audits
- GDPR compliance measures

### Ethical Considerations
- Clear educational purpose disclosure
- No actual financial products offered
- Transparent simulation boundaries
- Responsible dark pattern demonstration

---

**Lotus Payday Loan Simulator** - Educational tool for financial literacy and consumer protection research.

Built with â¤ï¸ for financial education and consumer protection.
